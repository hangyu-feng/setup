#!/bin/bash

gscompress() {
  if [ "$#" -lt 1 ]; then
    echo "Usage: gscompress file1.pdf [file2.pdf ...]"
    return 1
  fi

  for infile in "$@"; do
    if [[ "$infile" != *.pdf ]]; then
      echo "Skipping '$infile' (not a PDF)"
      continue
    fi

    # Remove .pdf extension and create output name
    local base="${infile%.pdf}"
    local outfile="${base}_compressed.pdf"

    echo "üîß Compressing $infile ‚Üí $outfile"

    gs -sDEVICE=pdfwrite \
       -dCompatibilityLevel=1.4 \
       -dPDFSETTINGS=/ebook \
       -dNOPAUSE -dQUIET -dBATCH \
       -sOutputFile="$outfile" \
       "$infile"

    if [ $? -eq 0 ]; then
      echo "‚úÖ Created $outfile"
    else
      echo "‚ùå Failed to compress $infile"
    fi
  done
}

# --- Main script execution ---
gscompress "$@"

